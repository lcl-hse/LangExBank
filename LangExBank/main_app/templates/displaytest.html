{% extends "index.html" %}
{% block head %}
{% load static %}
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link href="{% static "basic1.css" %}" rel="stylesheet" />
{% endblock %}
{% block main_body %}
<div class="container-fluid">
    <div class = "main">

        <div>
            {% autoescape off %}
                <form method="POST">
                {% csrf_token %}
                {% for test_section in task_set %}
                <div>
                    <!-- Name of the section: -->
                    <h1>{{ test_section.name }}</h1>
                    {% if test_section.supplement.url is not None %}
                        <div class="equalCols p-3">
                            <div>
                                <div class="section-text shadow mb-3 bg-white rounded">
                                    <!-- Text of the section -->
                                    {{ test_section.text }}
                                </div>
                                {% if test_section.section_type == 'r' %}
                                <div style="max-height: 25%">
                                    <h3>Answer sheet:</h3>
                                    <div class="form-group" style="max-height:300px; overflow: scroll;">

                                        {% for question in test_section.question_set.all %}
                                            <div class="mx-2">
                                            <b>{{ question.question_text }}</b>
                                                {% if question.get_answers %}
                                                    <br />
                                                    {% for answer in question.get_answers %}
                                                        <input type="radio" name="question_{{ question.id }}" value="{{ answer.answer_text }}">
                                                            {{ answer.answer_text }}
                                                        </input>
                                                        <br />
                                                    {% endfor %}
                                                {% else %}
                                                {% if question.multi_field %}
                                                {% for field in question.field_range %}
                                                <input type="text" class="form-control form-control-sm" name="question_{{ question.id }}_field_multi" cols="50" row="1">
                                                {% endfor %}
                                                {% else %}
                                                <input type="text" class="form-control form-control-sm" name="question_{{ question.id }}" cols="50" row="1">
                                                {% endif %}
                                                {% endif %}
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                            <div class="h-75 shadow p-3 mb-3 bg-white rounded">
                                <!-- Supplement for the section -->
                                {% if test_section.section_type == "r" %}
                                    <embed src="{{ test_section.supplement.url }}" type="application/pdf" style="height: 100%; width: 100%;">
                                    </embed>
                                {% elif test_section.section_type == "l" %}
                                    <!-- This is a listening section -->
                                    {% if request.session.rights == 'A' or request.session.rights == 'T' %}
                                        <!-- You are a admin or teacher -->
                                        {% if test_section.supplement is not None %}
                                            <!-- Supplement FileField is not None -->
                                            <audio controls id="sound_{{ test_section.id }}" src="{{ test_section.supplement.url }}">
                                                Your browser does not support the <code>audio</code> element.
                                            </audio>
                                        {% endif %}
                                    {% endif %}
                                    <div style="max-height: 25%">
                                        <h3>Answer sheet:</h3>
                                        <div class="form-group" style="max-height:300px; overflow: scroll;">

                                            {% for question in test_section.question_set.all %}
                                                <div class="mx-2">
                                                <b>{{ question.question_text }}</b>
                                                    {% if question.get_answers %}
                                                        <br />
                                                        {% for answer in question.get_answers %}
                                                            <input type="radio" name="question_{{ question.id }}" value="{{ answer.answer_text }}">
                                                                {{ answer.answer_text }}
                                                            </input>
                                                            <br />
                                                        {% endfor %}
                                                    {% else %}
                                                        {% if question.multi_field %}
                                                        {% for field in question.field_range %}
                                                        <input type="text" class="form-control form-control-sm" name="question_{{ question.id }}_{{ field }}_multi" cols="50" row="1">
                                                        {% endfor %}
                                                        {% else %}
                                                        <input type="text" class="form-control form-control-sm" name="question_{{ question.id }}" cols="50" row="1">
                                                        {% endif %}
                                                    {% endif %}
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% else %}
                                    Section type: {{ test_section.section_type }}
                                {% endif %}
                            </div>
                        </div>


                    {% else %}
                    <div class="equalCols p-3">
                        <div class="section-text shadow-lg mb-3 bg-white rounded">
                            <!-- Text of the section -->
                            {{ test_section.text }}
                        </div>
                        <div class="shadow-lg mb-3 bg-white rounded">
                            <h2 class="m-2">Answer sheet: </h2><br />
                            <div class="form-group">
                                {% for question in test_section.question_set.all %}
                                    <div class="mx-2">
                                    <b>{{ question.question_text }}</b>
                                        {% if question.get_answers %}
                                            <br />
                                            {% for answer in question.get_answers %}
                                                <input type="radio" name="question_{{ question.id }}" value="{{ answer.answer_text }}">
                                                    {{ answer.answer_text }}
                                                </input>
                                                <br />
                                            {% endfor %}
                                        {% else %}
                                            {% if question.multi_field %}
                                            {% for field in question.field_range %}
                                            <input type="text" class="form-control form-control-sm" name="question_{{ question.id }}_field_multi" cols="50" row="1">
                                            {% endfor %}
                                            {% else %}
                                            <input type="text" class="form-control form-control-sm" name="question_{{ question.id }}" cols="50" row="1">
                                            {% endif %}
                                        {% endif %}
                                    </div>
                                {% endfor %}
                             </div>

                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
                <input type="submit" class="btn btn-primary" value="Submit">
                </form>
            {% endautoescape %}
        </div>
    </div>
</div>
{% endblock %}